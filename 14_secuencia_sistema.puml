@startuml
!pragma charset UTF-8
skinparam defaultFontName Arial
title Diagrama de Secuencia - Creación y Gestión de Trámite

actor "Ciudadano" as C
actor "Ventanilla" as V
participant "Herramienta" as H
participant "Motor de Asignación" as MA
database "Expediente Digital" as BD
actor "Técnico" as T
actor "Supervisor" as S

== Registro de Trámite ==
C -> V : Entrega solicitud y documentos
activate V
V -> V : Valida requisitos
V -> H : Registra trámite
activate H
H -> BD : Crear expediente digital
activate BD
BD --> H : Expediente creado con ID único
deactivate BD
H --> V : Confirmación de registro
V --> C : Entrega número de expediente
deactivate V

== Asignación Automática ==
H -> MA : Solicitar asignación de responsable
activate MA
MA -> MA : Consulta grupo de técnicos según perfil
MA -> MA : Aplica algoritmo Round-Robin
MA -> H : Asignar técnico seleccionado
deactivate MA
H -> BD : Registrar asignación
activate BD
BD --> H : OK
deactivate BD

== Notificaciones ==
H -> T : Notificar nuevo trámite asignado
H -> S : Notificar asignación en panel
H -> C : Confirmar recepción de trámite

== Gestión de Fase ==
T -> H : Accede a trámite asignado
activate H
H -> BD : Consultar datos y documentos
activate BD
BD --> H : Información del expediente
deactivate BD
H --> T : Muestra expediente completo
deactivate H
T -> T : Realiza análisis técnico
T -> H : Carga informe y entregables
activate H
H -> BD : Almacenar documentos
activate BD
BD --> H : Documentos guardados
deactivate BD
H -> BD : Actualizar estado de fase
activate BD
BD --> H : Fase completada
deactivate BD

== Transición de Fase ==
H -> MA : Solicitar asignación siguiente fase
activate MA
MA -> MA : Identificar siguiente fase del trámite
MA -> MA : Seleccionar técnico según perfil requerido
MA -> H : Asignar nueva fase a técnico
deactivate MA
H -> BD : Registrar nueva asignación
H -> T : Notificar nueva asignación
H -> S : Actualizar seguimiento
deactivate H

@enduml

